<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ADIVINA LA PALABRA SECRETA</title>
  <meta name="description" content="Juego de adivinar la palabra del d√≠a en espa√±ol (estilo Wordle) 100% cliente, listo para GitHub Pages." />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#121213;           /* fondo general */
      --tile:#3a3a3c;         /* borde/tiles vac√≠os */
      --text:#ffffff;         /* texto principal */
      --muted:#d7dadc;        /* texto secundario */
      --hit:#00ba58;          /* correcto (verde) */
      --near:#ffb600;         /* casi (amarillo) */
      --miss:#3d3d3d;         /* no est√° (gris) */
      --accent:#ff7a00;       /* acento para CTA */
      --gap:0.5rem;           /* separaci√≥n est√°ndar */
    }
    html,body{height:100%;}
    body{
      margin:0; background:var(--bg); color:var(--text); font-family:'Nunito',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial; font-weight:400; line-height:1.45;
      display:flex; flex-direction:column; align-items:center;
    }
    header{
      width:100%; max-width:680px; padding:0.75rem 1rem; border-bottom:1px solid #2a2a2a; text-align:center; position:sticky; top:0; background:rgba(18,18,19,.85); backdrop-filter:saturate(180%) blur(6px);
    }
    h1{margin:0; font-size:1.25rem; letter-spacing:.08em; text-transform:uppercase; font-weight:700}
    .container{width:100%; max-width:680px; padding:1rem; display:flex; flex-direction:column; align-items:center; gap:var(--gap)}
    /* Tablero */
    #board{display:grid; grid-template-rows:repeat(var(--rows),1fr); gap:var(--gap); margin-top:.5rem; width:min(90vw,420px)}
    .row{display:grid; grid-template-columns:repeat(var(--cols),1fr); gap:var(--gap)}
    .tile{aspect-ratio:1/1; display:grid; place-items:center; border:1px solid var(--tile); font-weight:600; font-size:clamp(18px,5.2vw,28px); text-transform:uppercase; border-radius:.4rem;}
    .tile.filled{border-color:#565758}
    .tile.reveal{color:#fff; border-color:transparent;}
    .tile.hit{background:var(--hit)}
    .tile.near{background:var(--near)}
    .tile.miss{background:var(--miss)}

    /* Teclado */
    #kb{display:grid; gap:var(--gap); width:min(95vw,680px); margin-top:1rem}
    .kb-row{display:grid; grid-template-columns:repeat(10,1fr); gap:var(--gap)}
    .kb-row.low{grid-template-columns:1.5fr repeat(7,1fr) 1.5fr}
    .key{user-select:none; border:none; border-radius:.5rem; padding:.8rem .5rem; background:#818384; color:#fff; font-weight:700; text-transform:uppercase; letter-spacing:.02em}
    .key[data-code="Enter"], .key[data-code="Backspace"]{font-size:.9rem}
    .key.small{font-size:.85rem}
    .key.miss{background:var(--miss)}
    .key.near{background:var(--near)}
    .key.hit{background:var(--hit)}
    /* Resalta botones especiales */
    .key[data-code="Enter"] {
    background: #00ba58;   /* verde corporativo */
    color: #fff;
    font-weight: 600;
    }

    .key[data-code="Backspace"] {
    background: #3d3d3d;   /* gris para borrar */
    color: #fff;
    font-weight: 600;
    }

    /* Barra inferior (acciones) */
    .actions{display:flex; gap:var(--gap); align-items:center; justify-content:center; margin:.5rem 0 1rem}
    .btn{background:transparent; color:var(--muted); border:1px solid #2a2a2a; padding:.5rem .8rem; border-radius:.5rem; cursor:pointer; font-family:inherit; font-weight:700}
    .btn.primary{border-color:var(--accent); color:#fff}

    /* Mensajes */
    #toast{position:fixed; top:80px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,.85); color:#fff; padding:.6rem .9rem; border-radius:.5rem; opacity:0; pointer-events:none; transition:opacity .2s}
    #toast.show{opacity:1}
    #result{margin-top:.5rem; color:var(--muted); text-align:center}

    /* Modal de victoria */
    #win-overlay{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:9999}
    #win-overlay.show{display:flex}
    #win-overlay .overlay-backdrop{position:absolute; inset:0; background:rgba(0,0,0,.8)}
    #win-overlay .overlay-card{position:relative; z-index:1; background:#ffffff; color:#000; border:1px solid #00ba58; border-radius:10px; padding:1.25rem 1.5rem; width:min(520px,90vw); box-shadow:0 10px 30px rgba(0,0,0,.35); text-align:center}
    #win-overlay .overlay-card p{margin:0 0 .75rem 0; font-weight:700}
    #win-overlay .overlay-card .sub{margin:0; font-weight:400; color:#333}
    #win-overlay .overlay-card .btn{border-color:#00ba58; color:#00ba58}

    /* Mobile tweaks */
    @media (max-width:420px){
      .key{padding:.75rem .4rem}
      .kb-row.low{grid-template-columns:1.7fr repeat(7,1fr) 1.7fr}
    }
  </style>
</head>
<body>
  <header>
    <h1>GT ADIVINA LA PALABRA SECRETA</h1>
  </header>

  <main class="container">
    <div id="board" aria-label="Tablero del juego"></div>

    <div id="kb" aria-label="Teclado en pantalla"></div>

    <div class="actions">
      <button class="btn" id="btn-reset" title="Empezar de nuevo">Reiniciar</button>
      <button class="btn primary" id="btn-share" title="Copiar resultado">Compartir</button>
    </div>

    <div id="result" role="status"></div>
  </main>

  <div id="toast" role="alert"></div>

  <!-- Modal de victoria -->
  <div id="win-overlay" role="dialog" aria-modal="true">
    <div class="overlay-backdrop" data-close="1"></div>
    <div class="overlay-card" role="document">
      <p>Felicidades GT has adivinado la palabra secreta</p>
      <p class="sub">Gracias por jugar</p>
      <button class="btn" id="win-close" aria-label="Cerrar">Cerrar</button>
    </div>
  </div>

  <script>
    /************************************
     * CONFIGURACI√ìN R√ÅPIDA
     ************************************/
    // 1) Cambia la palabra objetivo aqu√≠ (usa MAY√öSCULAS; puede incluir √ë y tildes)
    let TARGET_WORD = "FIABILIDAD"; // ‚Üê c√°mbiala f√°cil

    // 2) Tambi√©n puedes fijarla por URL: ?w=palabra (sobrescribe la de arriba)
    const params = new URLSearchParams(location.search);
    if (params.get('w')) TARGET_WORD = params.get('w');

    // 3) Longitud de la palabra y n√∫mero de intentos
    const WORD_LENGTH = 10;   // ajusta si usas palabras de otra longitud
    const MAX_TRIES   = 6;

    // 4) Paleta de emojis para compartir
    const EMOJI = { hit:"üü©", near:"üü®", miss:"‚¨õ" };

    /************************************
     * UTILIDADES DE IDIOMA
     ************************************/
    const KB_ROWS = [
      "QWERTYUIOP".split(""),
      "ASDFGHJKL√ë".split(""),
      ["Enter","Z","X","C","V","B","N","M","Backspace"]
    ];

    // Normaliza tildes, PERO conserva √ë
    function stripAccentsKeepEnye(str){
      const PROT_UP = "__ENYE_UP__"; const PROT_LO = "__ENYE_LO__";
      str = str.replace(/√ë/g, PROT_UP).replace(/√±/g, PROT_LO);
      const map = [
        [/√Å|√Ä|√Ç|√É|√Ñ/g, "A"], [/√°|√†|√¢|√£|√§/g, "a"],
        [/√â|√à|√ä|√ã/g, "E"], [/√©|√®|√™|√´/g, "e"],
        [/√ç|√å|√é|√è/g, "I"], [/√≠|√¨|√Æ|√Ø/g, "i"],
        [/√ì|√í|√î|√ï|√ñ/g, "O"], [/√≥|√≤|√¥|√µ|√∂/g, "o"],
        [/√ö|√ô|√õ|√ú/g, "U"], [/√∫|√π|√ª|√º/g, "u"]
      ];
      for (const [re,to] of map) str = str.replace(re,to);
      return str.replace(new RegExp(PROT_UP,'g'),"√ë").replace(new RegExp(PROT_LO,'g'),"√±");
    }
    function normalizeWord(str){ return stripAccentsKeepEnye(str).toUpperCase().replace(/[^A-Z√ë]/g,""); }

    TARGET_WORD = normalizeWord(TARGET_WORD);

    // Estado del juego
    let currentRow = 0; let currentCol = 0; let grid = [];
    let finished = false; let won = false;

    // Elementos
    const boardEl = document.getElementById('board');
    const kbEl    = document.getElementById('kb');
    const toastEl = document.getElementById('toast');
    const resultEl= document.getElementById('result');
    const winOverlay = document.getElementById('win-overlay');
    const winClose   = document.getElementById('win-close');

    /************************************
     * RENDERIZADO
     ************************************/
    function setupBoard(){
      boardEl.style.setProperty('--rows', MAX_TRIES);
      boardEl.style.setProperty('--cols', WORD_LENGTH);
      boardEl.innerHTML = '';
      for (let r=0; r<MAX_TRIES; r++){
        const row = document.createElement('div'); row.className='row';
        const arr = grid[r] || new Array(WORD_LENGTH).fill({ch:"", st:""});
        grid[r] = arr;
        for (let c=0; c<WORD_LENGTH; c++){
          const t = document.createElement('div'); t.className = 'tile';
          const cell = grid[r][c];
          if (cell.ch){ t.textContent = cell.ch; t.classList.add('filled'); }
          if (cell.st){ t.classList.add('reveal', cell.st); }
          row.appendChild(t);
        }
        boardEl.appendChild(row);
      }
    }

    function setupKeyboard(){
      kbEl.innerHTML = '';
      const rows = [document.createElement('div'), document.createElement('div'), document.createElement('div')];
      rows[0].className='kb-row top'; rows[1].className='kb-row mid'; rows[2].className='kb-row low';
      KB_ROWS.forEach((rowKeys, idx)=>{
        rowKeys.forEach(k=>{
          const b = document.createElement('button'); b.className='key';
          b.textContent = (k==='Backspace'? 'Borrar' : (k==='Enter'? 'Enviar' : k));
          b.dataset.code = k;
          if (k==='Enter' || k==='Backspace') b.classList.add('small');
          b.addEventListener('click',()=>handleInput(k));
          rows[idx].appendChild(b);
        });
        kbEl.appendChild(rows[idx]);
      });
    }

    function toast(msg){ toastEl.textContent = msg; toastEl.classList.add('show'); setTimeout(()=>toastEl.classList.remove('show'), 1400); }

    function updateBoardCell(r,c){
      const tile = boardEl.children[r].children[c]; const cell = grid[r][c];
      tile.textContent = cell.ch || '';
      tile.className = 'tile' + (cell.ch?' filled':'') + (cell.st? ' reveal '+cell.st:'');
    }

    function colorKeyboard(letter, status){
      const btn = kbEl.querySelector(`.key:not([data-code="Enter"]):not([data-code="Backspace"])`+`[data-code="${letter}"]`);
      if(!btn) return;
      const order = {miss:1, near:2, hit:3};
      const curr = btn.dataset.status ? order[btn.dataset.status] : 0;
      if (order[status] > curr){
        btn.dataset.status = status; btn.classList.remove('miss','near','hit'); btn.classList.add(status);
      }
    }

    /************************************
     * L√ìGICA DEL JUEGO
     ************************************/
    function handleInput(key){
      if (finished) return;
      if (key === 'Backspace') { removeLetter(); return; }
      if (key === 'Enter')     { submitRow();   return; }
      if (/^[A-Z√ë]$/.test(key)) addLetter(key);
    }

    function addLetter(ch){
      if (currentCol >= WORD_LENGTH) return;
      grid[currentRow][currentCol] = {ch, st:""};
      updateBoardCell(currentRow,currentCol);
      currentCol++;
    }

    function removeLetter(){
      if (currentCol <= 0) return; currentCol--;
      grid[currentRow][currentCol] = {ch:"", st:""};
      updateBoardCell(currentRow,currentCol);
    }

    function evaluateGuess(guess){
      const g = normalizeWord(guess);
      const t = TARGET_WORD;
      const res = new Array(WORD_LENGTH).fill('miss');
      const count = {};
      for (let i=0;i<WORD_LENGTH;i++){ const ch=t[i]; count[ch]=(count[ch]||0)+1; }
      for (let i=0;i<WORD_LENGTH;i++){ if (g[i]===t[i]){ res[i]='hit'; count[g[i]]--; } }
      for (let i=0;i<WORD_LENGTH;i++){ if (res[i]==='hit') continue; const ch=g[i]; if (count[ch]>0){ res[i]='near'; count[ch]--; } }
      return res;
    }

    function submitRow(){
      if (currentCol < WORD_LENGTH){ toast('Completa la palabra'); return; }
      const guess = grid[currentRow].map(x=>x.ch).join('');
      const evals = evaluateGuess(guess);
      for (let i=0;i<WORD_LENGTH;i++){
        grid[currentRow][i].st = evals[i];
        updateBoardCell(currentRow,i);
        colorKeyboard(grid[currentRow][i].ch, evals[i]);
      }
      const ok = evals.every(x=>x==='hit');
      if (ok){
        finished = true; won = true; resultEl.textContent = `¬°Acertaste! La palabra era "${TARGET_WORD}".`; toast('¬°Excelente!');
        showWinModal();
        return;
      }
      currentRow++; currentCol=0;
      if (currentRow>=MAX_TRIES){ finished=true; won=false; resultEl.textContent = `Int√©ntalo de nuevo en el bot√≥n REINICIAR`; toast('Se acabaron los intentos.'); }
    }

    function onKeydown(e){
      const k = e.key;
      if (/^[a-zA-Z]$/.test(k)) handleInput(k.toUpperCase());
      else if (k==='Enter' || k==='Backspace') handleInput(k);
      const map = { '√°':'A','√©':'E','√≠':'I','√≥':'O','√∫':'U','√Å':'A','√â':'E','√ç':'I','√ì':'O','√ö':'U','√±':'√ë','√ë':'√ë' };
      if (map[k]) handleInput(map[k]);
    }

    function resetGame(){
      currentRow=0; currentCol=0; grid=[]; finished=false; won=false; resultEl.textContent='';
      setupBoard(); setupKeyboard(); hideWinModal();
    }

    function shareResult(){
      let out = `Mira mi resultado en: Adivina la palabra secreta ${won?currentRow:MAX_TRIES}/${MAX_TRIES}\n juega tu tambi√©n!`;
      for (let r=0;r<Math.min(currentRow, MAX_TRIES); r++){
        const line = (grid[r]||[]).map(c=>({hit:'üü©',near:'üü®',miss:'‚¨õ'})[c.st||'miss']).join('');
        out += line + "\n";
      }
      if (finished && !won){
        const last = (grid[MAX_TRIES-1]||[]).map(c=>({hit:'üü©',near:'üü®',miss:'‚¨õ'})[c.st||'miss']).join('');
        if (last) out += last + "\n";
      }
      out += location.href.split('?')[0];
      navigator.clipboard.writeText(out).then(()=>toast('Resultado copiado'));
    }

    function showWinModal(){ winOverlay.classList.add('show'); }
    function hideWinModal(){ winOverlay.classList.remove('show'); }

    // Inicializar
    setupBoard();
    setupKeyboard();
    document.addEventListener('keydown', onKeydown);
    document.getElementById('btn-reset').addEventListener('click', resetGame);
    document.getElementById('btn-share').addEventListener('click', shareResult);
    winOverlay.querySelector('[data-close]')?.addEventListener('click', hideWinModal);
    winClose.addEventListener('click', hideWinModal);
  </script>
</body>
</html>
